---
import CarouselDemo from "@/components/carousel-demo"
import HeartButton from "@/components/HeartButton"

interface Props {
	photos: string[]
	title: string
	price?: number
	id: string
	rooms?: number
	m2?: number
	location?: string
	type?: string
}

const {
	photos,
	title,
	price,
	id,
	rooms,
	m2,
	location = "Argentina",
	type = "Propiedad",
} = Astro.props
---

<article class="group animate-fade-in" style={`animation-delay: ${Math.random() * 0.2}s`}>
	<div transition:name={`property-image-${id}`} class="relative">
		<CarouselDemo photos={photos} client:load />
		<div class="absolute right-3 top-3 z-10">
			<HeartButton propertyId={id} client:load />
		</div>
		<a
			href={`/property/${id}`}
			class="absolute inset-0 z-[1]"
			aria-label={`Ver detalles de ${title}`}
			onclick="const isButton = event.target.closest('button'); if (isButton) event.preventDefault();"
		></a>
	</div>
	<a href={`/property/${id}`} class="block pt-3">
		<div class="flex items-start justify-between gap-2">
			<h2 class="line-clamp-1 text-[15px] font-semibold text-airbnb-gray-500">
				{title}
			</h2>
		</div>
		<p class="mt-0.5 text-[15px] text-airbnb-gray-400">
			{type} · {location}
		</p>
		<div class="mt-1 flex items-center gap-3 text-sm text-airbnb-gray-400">
			{
				rooms && (
					<span class="flex items-center gap-1">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							class="size-4"
						>
							<>
								<path d="M2 4v16" />
								<path d="M2 8h18a2 2 0 0 1 2 2v10" />
								<path d="M2 17h20" />
								<path d="M6 8v9" />
							</>
						</svg>
						{rooms} hab.
					</span>
				)
			}
			{
				m2 && (
					<span class="flex items-center gap-1">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							class="size-4"
						>
							<>
								<rect width="18" height="18" x="3" y="3" rx="2" />
								<path d="M3 9h18" />
								<path d="M9 21V9" />
							</>
						</svg>
						{m2} m²
					</span>
				)
			}
		</div>
		<p class="mt-2">
			<span class="font-semibold text-airbnb-gray-500">
				{
					price
						? price
								.toLocaleString("en-US", { style: "currency", currency: "USD" })
								.replace(".00", "")
						: "Consultar precio"
				}
			</span>
			{price && <span class="font-normal text-airbnb-gray-400"> USD</span>}
		</p>
	</a>
</article>
